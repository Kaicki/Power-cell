<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CinePower - Catálogo</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }
  body { background:#000; color:#fff; }
  header { background:#111; padding:20px; text-align:center; font-size:28px; font-weight:bold; }
  .lista-filmes { display:flex; overflow-x:auto; padding:20px; gap:10px; scroll-behavior:smooth; }
  .filme { flex:0 0 auto; width:160px; cursor:pointer; position:relative; transition: transform .3s; }
  .filme img { width:100%; border-radius:8px; }
  .filme:hover { transform:scale(1.1); }
  .filme-info { text-align:center; margin-top:5px; }
  #playerModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); justify-content:center; align-items:center; }
  #playerModal iframe { width:80%; height:80%; border:none; border-radius:8px; }
  #playerModal button { position:absolute; top:20px; right:20px; padding:8px 12px; font-size:16px; background:#ff3333; border:none; border-radius:4px; cursor:pointer; color:#fff; }
</style>
</head>
<body>

<header>CinePower</header>

<div class="lista-filmes" id="catalogo"></div>

<!-- Player Modal -->
<div id="playerModal">
  <button onclick="fecharPlayer()">X</button>
  <iframe id="playerFrame" src="" allowfullscreen></iframe>
</div>

<!-- Supabase JS -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
<script>
// Configuração do Supabase
const supabaseUrl = 'https://bbbhatsqjnrjfbhkwrcp.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJiYmhhdHNxam5yamZiaGt3cmNwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAxMTMxOTYsImV4cCI6MjA3NTY4OTE5Nn0.KxPfc0SLkALTFsayNWm3_zAUEdBQwMlNlHUYZlcU7FU';
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

const catalogoEl = document.getElementById("catalogo");

// Abrir player
function abrirPlayer(driveId){
  const iframe = document.getElementById("playerFrame");
  iframe.src = `https://drive.google.com/file/d/${driveId}/preview`;
  document.getElementById("playerModal").style.display="flex";
}

// Fechar player
function fecharPlayer(){
  const iframe = document.getElementById("playerFrame");
  iframe.src="";
  document.getElementById("playerModal").style.display="none";
}

// Carregar filmes do Supabase
async function carregarFilmes(){
  catalogoEl.innerHTML="";
  const { data: filmes, error } = await supabase.from('filmes').select('*');
  if(error){ console.error(error); return; }
  filmes.forEach(f=>{
    const card = document.createElement("div");
    card.className = "filme";
    card.innerHTML = `
      <img src="${f.capa}" alt="${f.titulo}">
      <div class="filme-info">
        <h4>${f.titulo}</h4>
      </div>`;
    card.onclick = ()=>abrirPlayer(f.driveId);
    catalogoEl.appendChild(card);
  });
}

// Inicializa
carregarFilmes();
</script>

</body>
</html>
